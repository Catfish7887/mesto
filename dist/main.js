(()=>{"use strict";class e{constructor(e){this._popupSelector=e,this._closeButton=this._popupSelector.querySelector(".popup__close-btn"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupSelector.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_opened")&&this.close()}))}}class t extends e{constructor(e,t){super(e),this._submitFunction=t,this._form=this._popupSelector.querySelector(".popup__form"),this._inputs=Array.from(this._popupSelector.querySelectorAll(".popup__input"))}_getInputValues(){return this._values={},this._inputs.forEach((e=>{this._values[e.name]=e.value})),this._values}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitFunction(this._getInputValues())}))}}const s=document.querySelector(".popup_type_edit"),i=s.querySelector("#name"),r=s.querySelector("#about"),n=document.querySelector(".popup_type_add"),o=n.querySelector(".popup__form"),a=document.querySelector(".popup_type_image"),c=document.querySelector(".profile__edit-btn"),l=document.querySelector(".profile__add-btn"),u=document.querySelector(".profile__name"),p=document.querySelector(".profile__about"),_=document.querySelector(".place-template").content,d=document.querySelector(".places__list"),h={},m=new class{constructor({userName:e,about:t}){this._userName=e,this._about=t}getUserInfo(){return{name:this._userName.innerText,about:this._about.innerText}}setUserInfo(e,t){this._userName.innerText=e.value,this._about.innerText=t.value}}({userName:u,about:p}),v=new class extends e{constructor(e){super(e),this._image=this._popupSelector.querySelector(".popup__image"),this._description=this._popupSelector.querySelector(".popup__image-caption")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._description.textContent=e}}(a);v.setEventListeners();const f=new t(n,(function(e){const t=S(_,e,b);y.addItem(t),f.close()}));f.setEventListeners();const g=new t(s,(function(){m.setUserInfo(i,r),g.close()}));g.setEventListeners();const y=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=s}addItem(e){this._container.prepend(e)}renderAll(){this._items.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=S(_,e,b);y.addItem(t)}},d);function S(e,t,s){return new class{constructor(e,t,s){this._image=e.link,this._name=e.name,this._handleCardClick=t,this._template=s}_getTemplate(){return this._template.cloneNode(!0).children[0]}_like(){this._likeButton.classList.toggle("place__like-btn_active")}_deleteCard(){this._card.remove()}_openPopup(){this._handleCardClick(this._name,this._image)}_addListeners(){this._card.querySelector(".place__delete-btn").addEventListener("click",(()=>{this._deleteCard()})),this._likeButton.addEventListener("click",(()=>{this._like()})),this._cardImage.addEventListener("click",(()=>{this._openPopup()}))}createCard(){return this._card=this._getTemplate(),this._cardImage=this._card.querySelector(".place__image"),this._likeButton=this._card.querySelector(".place__like-btn"),this._card.querySelector(".place__name").textContent=this._name,this._cardImage.src=this._image,this._cardImage.alt=this._name,this._addListeners(),this._card}}(t,s,e).createCard()}function b(e,t){v.open(e,t)}var E;y.renderAll(),E={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-btn",inactiveButtonClass:"popup__submit-btn_inactive",inputErrorClass:"popup__input_invalid",errorClass:"popup__input-error_visible"},Array.from(document.querySelectorAll(E.formSelector)).forEach((e=>{const t=new class{constructor(e,t){this._config=e,this._formEl=t,this._inputList=Array.from(this._formEl.querySelectorAll(this._config.inputSelector)),this._submitButton=this._formEl.querySelector(this._config.submitButtonSelector)}_showInputError(e,t){const s=this._formEl.querySelector(`.${e.id}-error`);s.textContent=t,e.classList.add(this._config.inputErrorClass),s.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`.${e.id}-error`);t.classList.remove(this._config.errorClass),e.classList.remove(this._config.inputErrorClass),t.textContent=""}_isInputValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._submitButton.setAttribute("disabled",!0),this._submitButton.classList.add(this._config.inactiveButtonClass)):(this._submitButton.removeAttribute("disabled",!0),this._submitButton.classList.remove(this._config.inactiveButtonClass))}enableValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._isInputValid(e),this._toggleButtonState()}))}))}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}}(E,e),s=e.getAttribute("name");h[s]=t,t.enableValidation()})),c.addEventListener("click",(function(){g.open();const e=m.getUserInfo();r.value=e.about,i.value=e.name,h.editForm.resetValidation()})),l.addEventListener("click",(function(){o.reset(),f.open(),h.cardForm.resetValidation()}))})();